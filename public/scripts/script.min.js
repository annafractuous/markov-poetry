"use strict";var _createClass=function(){function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}}();function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var App=function(){function t(){_classCallCheck(this,t),this.dictionary=dictionary,this.dictionaryKeys=Object.keys(this.dictionary),this.suggestionEls=document.getElementsByClassName("suggestion-field"),this.composition=document.getElementById("composition-field"),this.input=document.getElementById("initial-input"),this.restartBtn=document.getElementById("restart-btn"),this.refreshBtn=document.getElementById("refresh-btn"),this.backBtn=document.getElementById("back-btn"),this.defaultText=this.composition.innerText,this.firstWord=!0,this.addListeners(),console.log(dictionary)}return _createClass(t,[{key:"addListeners",value:function(){this.activeListener(),this.inactiveListener(),this.typingListener(),this.backspaceListener(),this.selectionListener(),this.buttonListeners()}},{key:"activeListener",value:function(){var t=this;this.input.addEventListener("click",function(){return t.clearDefaultText()})}},{key:"inactiveListener",value:function(){var e=this;window.addEventListener("click",function(t){return e.replaceDefaultText(t)})}},{key:"typingListener",value:function(){var e=this;this.input.addEventListener("input",function(t){return e.beginComposition(t)})}},{key:"backspaceListener",value:function(){var e=this;window.addEventListener("keyup",function(t){8!==t.keyCode||e.firstWord||e.deleteLastWord()})}},{key:"selectionListener",value:function(){var e=this;[].concat(_toConsumableArray(this.suggestionEls)).forEach(function(t){t.addEventListener("click",function(t){return e.updateComposition(t)})})}},{key:"buttonListeners",value:function(){var t=this;this.restartBtn.addEventListener("click",function(){return t.restartComposition()}),this.refreshBtn.addEventListener("click",function(){return t.refreshSuggestions()}),this.backBtn.addEventListener("click",function(){return t.deleteLastWord()})}},{key:"clearDefaultText",value:function(){""==this.input.value&&(this.composition.innerText="")}},{key:"replaceDefaultText",value:function(t){"initial-input"!==t.target.id&&""==this.input.value&&(this.composition.innerText=this.defaultText)}},{key:"beginComposition",value:function(t){var e=void 0;e=(e=(e=t.target.value).split(" ")[0]).trim().toLowerCase(),this.composition.innerText=e,this.getSuggestions(e)}},{key:"getSuggestions",value:function(t){var e=this.dictionary[t],n=[];if(e){var i=this.makeUnique(e);if(i.length<=3)n=i;else for(;n.length<3;){var s=this.getRandomEl(e);n.includes(s)||n.push(s)}}this.returnSuggestions(n)}},{key:"returnSuggestions",value:function(t){for(var e=0;e<3;e++)t[e]?this.suggestionEls[e].innerText=t[e]:this.suggestionEls[e].innerText=""}},{key:"refreshSuggestions",value:function(){var t=this.getLastWord();this.getSuggestions(t)}},{key:"clearSuggestions",value:function(){[].concat(_toConsumableArray(this.suggestionEls)).forEach(function(t){t.innerText=""})}},{key:"getLastWord",value:function(){var t=this.composition.innerText.split(" ");return t[t.length-1]}},{key:"updateComposition",value:function(t){var e=t.target.innerText;e&&(this.addToComposition(e),this.getSuggestions(e),this.firstWord&&this.disableInput())}},{key:"addToComposition",value:function(t){this.composition.innerText+=" "+t}},{key:"disableInput",value:function(){this.input.disabled=!0,this.firstWord=!1,this.toggleButtonsState(!1)}},{key:"toggleButtonsState",value:function(e){[this.restartBtn,this.refreshBtn,this.backBtn].forEach(function(t){e?t.classList.add("disabled"):t.classList.remove("disabled")})}},{key:"deleteLastWord",value:function(){var t=this.composition.innerText.split(" ");t.pop(),t.length?(this.composition.innerText=t.join(" "),this.refreshSuggestions()):this.restartComposition()}},{key:"restartComposition",value:function(){this.input.disabled=!1,this.input.value="",this.input.focus(),this.composition.innerText="",this.firstWord=!0,this.clearSuggestions(),this.toggleButtonsState(!0)}},{key:"makeUnique",value:function(t){return[].concat(_toConsumableArray(new Set(t)))}},{key:"getRandomEl",value:function(t){return t[Math.floor(Math.random()*t.length)]}}]),t}();document.addEventListener("DOMContentLoaded",function(){MuseMachina=new App});